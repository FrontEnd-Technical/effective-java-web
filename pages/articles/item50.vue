<script setup lang="ts">
definePageMeta({
    layout: 'item-default',
    title: 'Item 50: Make defensive copies when needed'
})

import { code_block } from '~/data/item50'

</script>

<template>
    <div class="main">
        <p>
            Nguy√™n t·∫Øc "Make defensive copies when needed" (T·∫°o c√°c b·∫£n sao ph√≤ng th·ªß khi c·∫ßn thi·∫øt) c√≥ nghƒ©a l√† khi m·ªôt
            l·ªõp c·ªßa b·∫°n ch·ª©a c√°c tr∆∞·ªùng l√† ƒë·ªëi t∆∞·ª£ng kh·∫£ bi·∫øn (mutable), b·∫°n ph·∫£i <strong>t·∫°o ra c√°c b·∫£n sao c·ªßa nh·ªØng
                ƒë·ªëi t∆∞·ª£ng ƒë√≥</strong> ƒë·ªÉ b·∫£o v·ªá tr·∫°ng th√°i n·ªôi b·ªô c·ªßa l·ªõp kh·ªèi b·ªã thay ƒë·ªïi t·ª´ b√™n ngo√†i.
        </p><br />
        <p>
            Vi·ªác n√†y l√† m·ªôt k·ªπ thu·∫≠t ph√≤ng th·ªß c·ª±c k·ª≥ quan tr·ªçng ƒë·ªÉ <strong>b·∫£o to√†n c√°c quy t·∫Øc b·∫•t bi·∫øn
                (invariants)</strong> c·ªßa l·ªõp b·∫°n, ƒë·∫∑c bi·ªát l√† khi b·∫°n mu·ªën t·∫°o ra m·ªôt l·ªõp b·∫•t bi·∫øn.
        </p><br />
        <hr><br>
        <Heading1 title="T·ªïng quan v·ªÅ Nguy√™n t·∫Øc" />
        <p>
            M·ªôt l·ªõp c√≥ th·ªÉ b·ªã t·∫•n c√¥ng n·∫øu n√≥ ch·∫•p nh·∫≠n ho·∫∑c tr·∫£ v·ªÅ c√°c tham chi·∫øu ƒë·∫øn c√°c ƒë·ªëi t∆∞·ª£ng kh·∫£ bi·∫øn. C√≥ hai
            th·ªùi ƒëi·ªÉmËÑÜÂº±:
        </p><br />
        <ol class="list-decimal pl-5 mt-3 space-y-1.5">
            <li><strong>Trong constructor:</strong> N·∫øu b·∫°n l∆∞u tr·ªØ tr·ª±c ti·∫øp m·ªôt tham chi·∫øu ƒë·∫øn m·ªôt ƒë·ªëi t∆∞·ª£ng kh·∫£ bi·∫øn
                m√† client truy·ªÅn v√†o, client ƒë√≥ v·∫´n c√≥ th·ªÉ thay ƒë·ªïi ƒë·ªëi t∆∞·ª£ng ƒë√≥ sau khi n√≥ ƒë√£ ƒë∆∞·ª£c kh·ªüi t·∫°o.</li>
            <li><strong>Trong getter:</strong> N·∫øu b·∫°n tr·∫£ v·ªÅ m·ªôt tham chi·∫øu tr·ª±c ti·∫øp ƒë·∫øn m·ªôt tr∆∞·ªùng kh·∫£ bi·∫øn n·ªôi b·ªô,
                client c√≥ th·ªÉ s·ª≠ d·ª•ng tham chi·∫øu ƒë√≥ ƒë·ªÉ thay ƒë·ªïi tr·∫°ng th√°i b√™n trong c·ªßa l·ªõp b·∫°n.</li>
        </ol><br />
        <div class="pl-3">
            <BlockOpinion opinion="V·∫•n ƒë·ªÅ: L·ªõp b·ªã t·∫•n c√¥ng üí£">
                <p>H√£y xem x√©t m·ªôt l·ªõp <span class="code">Period</span> ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ b·∫•t bi·∫øn, nh∆∞ng l·∫°i kh√¥ng t·∫°o
                    b·∫£n sao ph√≤ng th·ªß.</p><br />
                <p><strong>V√≠ d·ª• v·ªÅ l·ªõp kh√¥ng an to√†n:</strong></p>
                <CodeBlock :code="code_block.method1"></CodeBlock>
                <p><strong>C√°ch t·∫•n c√¥ng:</strong></p>
                <CodeBlock :code="code_block.method2"></CodeBlock>
            </BlockOpinion>
        </div>
        <hr><br>
        <Heading1 title="Gi·∫£i ph√°p: Defensive Copies ‚úÖ" />
        <p>
            ƒê·ªÉ b·∫£o v·ªá l·ªõp <span class="code">Period</span>, ch√∫ng ta ph·∫£i t·∫°o c√°c b·∫£n sao ph√≤ng th·ªß cho c√°c tham s·ªë kh·∫£
            bi·∫øn trong constructor v√† cho c√°c tr∆∞·ªùng khi tr·∫£ v·ªÅ t·ª´ getter.
        </p><br />

        <p><strong>C√°ch l√†m t·ªët nh·∫•t:</strong></p>
        <CodeBlock :code="code_block.method3"></CodeBlock>
        <div class="pl-3">
            <BlockOpinion opinion="L·ª£i √≠ch">
                <ul class="list-disc pl-5 mt-3 space-y-1.5">
                    <li><strong>B·∫•t bi·∫øn ƒë∆∞·ª£c b·∫£o to√†n:</strong> B·∫•t k·ª≥ thay ƒë·ªïi n√†o client th·ª±c hi·ªán tr√™n c√°c ƒë·ªëi t∆∞·ª£ng
                        <span class="code">Date</span> c·ªßa h·ªç s·∫Ω kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn tr·∫°ng th√°i b√™n trong c·ªßa <span
                            class="code">Period</span>.
                    </li>
                    <li><strong>ƒê√≥ng g√≥i ho√†n to√†n:</strong> Tr·∫°ng th√°i n·ªôi b·ªô c·ªßa l·ªõp ƒë∆∞·ª£c b·∫£o v·ªá ho√†n to√†n kh·ªèi s·ª± can
                        thi·ªáp t·ª´ b√™n ngo√†i.</li>
                </ul>
            </BlockOpinion>
            <BlockOpinion opinion="L∆∞u √Ω">
                <ul class="list-disc pl-5 mt-3 space-y-1.5">
                    <li><strong>S·ª≠ d·ª•ng c√°c ki·ªÉu b·∫•t bi·∫øn:</strong> C√°ch t·ªët nh·∫•t ƒë·ªÉ tr√°nh ph·∫£i t·∫°o b·∫£n sao ph√≤ng th·ªß l√†
                        s·ª≠ d·ª•ng c√°c ki·ªÉu b·∫•t bi·∫øn cho c√°c tr∆∞·ªùng c·ªßa b·∫°n ngay t·ª´ ƒë·∫ßu (v√≠ d·ª•: d√πng <span
                            class="code">java.time.Instant</span> thay v√¨ <span class="code">java.util.Date</span>).
                    </li>
                    <li><strong>Hi·ªáu nƒÉng:</strong> Vi·ªác t·∫°o b·∫£n sao c√≥ th·ªÉ t·ªën k√©m. N·∫øu hi·ªáu nƒÉng l√† y·∫øu t·ªë quan tr·ªçng,
                        b·∫°n c√≥ th·ªÉ t√†i li·ªáu h√≥a r·∫±ng tr√°ch nhi·ªám thu·ªôc v·ªÅ ng∆∞·ªùi g·ªçi, nh∆∞ng ƒë√¢y l√† m·ªôt l·ª±a-ch·ªçn r·ªßi ro.
                    </li>
                </ul>
            </BlockOpinion>
        </div><br>
        <p>
            <strong>K·∫øt lu·∫≠n:</strong> B·∫•t c·ª© khi n√†o m·ªôt l·ªõp c·ªßa b·∫°n, ƒë·∫∑c bi·ªát l√† m·ªôt l·ªõp b·∫•t bi·∫øn, ch·ª©a c√°c tr∆∞·ªùng
            l√† ƒë·ªëi t∆∞·ª£ng kh·∫£ bi·∫øn, h√£y <strong>lu√¥n t·∫°o c√°c b·∫£n sao ph√≤ng th·ªß</strong>. H√£y sao ch√©p c√°c tham s·ªë kh·∫£
            bi·∫øn trong constructor tr∆∞·ªõc khi ki·ªÉm tra v√† l∆∞u tr·ªØ ch√∫ng, v√† sao ch√©p c√°c tr∆∞·ªùng kh·∫£ bi·∫øn trong getter
            tr∆∞·ªõc khi tr·∫£ v·ªÅ ch√∫ng.
        </p><br />
    </div>
</template>
<style scoped></style>